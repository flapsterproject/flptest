function stoarr(e="",t=String){return String(e).split(",").map(e=>t(e.trim())).filter(e=>e)}function buildChannelInput(e){const t={};var s;return e.name&&(t.name=e.name),e.description&&(t.description=e.description),!isNaN(e.capacity)&&0<=e.capacity&&(t.capacity=e.capacity),e.tags&&0<(s=stoarr(e.tags)).length&&(t.tags=s),"capacity"in e&&0<=parseInt(e.capacity,10)&&(t.capacity=parseInt(e.capacity,10)),"private"in e&&(t.private=!!e.private),"visible"in e&&(t.visible=!!e.visible),"password"in e&&(t.password=e.password),0<e.ownerId&&(t.ownerId=e.ownerId),e.ownerAcl&&(t.ownerAcl=e.ownerAcl),e.memberAcl&&(t.memberAcl=e.memberAcl),e.guestAcl&&(t.guestAcl=e.guestAcl),t}globalThis.C3.Plugins.GamePush_Channels.Acts={FetchChannel(e){return this.gp.channels.fetchChannel({channelId:e}).then(e=>{this.curChannel=e,this.handleResult(!0),this._trigger(this.conditions.OnChannelFetch)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnChannelFetchError)})},FetchChannels(t,e,s,n,i,h,r,a){return this.gp.channels.fetchChannels({ids:stoarr(e,Number),tags:stoarr(s),search:n,onlyOwned:i,onlyJoined:h,limit:r,offset:a}).then(e=>{this.channels.list=e.items,this.channels.lastRequest="FetchChannels",this.canLoadMore=e.canLoadMore,this.lastLabel=t,this.handleResult(!0),this._trigger(this.conditions.OnChannelsFetch),this._trigger(this.conditions.OnChannelsAnyFetch)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnChannelsFetchError),this._trigger(this.conditions.OnChannelsAnyFetchError)})},FetchMoreChannels(t,e,s,n,i,h,r){return this.gp.channels.fetchMoreChannels({ids:stoarr(e,Number),tags:stoarr(s),search:n,onlyOwned:i,onlyJoined:h,limit:r}).then(e=>{this.channels.list=e.items,this.channels.lastRequest="FetchChannels",this.canLoadMore=e.canLoadMore,this.lastLabel=t,this.handleResult(!0),this._trigger(this.conditions.OnChannelsFetchMore),this._trigger(this.conditions.OnChannelsAnyFetchMore)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnChannelsFetchMoreError),this._trigger(this.conditions.OnChannelsAnyFetchMoreError)})},CreateChannel(e){const t=buildChannelInput(this.nextChannel);return t.template=e,this.nextChannel={},this.gp.channels.createChannel(t).then(e=>{this.curChannel=e,this.handleResult(!0),this._trigger(this.conditions.OnChannelsCreate)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnChannelsCreateError)})},UpdateChannel(e){const t=buildChannelInput(this.nextChannel);return t.channelId=e,this.nextChannel={},this.gp.channels.updateChannel(t).then(e=>{this.curChannel=e,this.handleResult(!0),this._trigger(this.conditions.OnChannelsUpdate)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnChannelsUpdateError)})},DeleteChannel(e){return this.gp.channels.deleteChannel({channelId:e}).then(()=>{this.handleResult(!0),this._trigger(this.conditions.OnChannelsDelete)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnChannelsDeleteError)})},ResetNextChannelState(){this.nextChannel={}},SetNextChannelName(e){this.nextChannel.name=e},SetNextChannelDescription(e){this.nextChannel.description=e},SetNextChannelOwnerID(e){this.nextChannel.ownerId=e},SetNextChannelPassword(e){this.nextChannel.password=e},SetNextChannelCapacity(e){this.nextChannel.capacity=e},SetNextChannelVisible(e){this.nextChannel.visible=e},SetNextChannelPrivate(e){this.nextChannel.private=e},SetNextChannelTags(e){this.nextChannel.tags=e},SetNextChannelACL(e,t,s,n,i,h,r,a,c,o){e=this.mappers.channelAclRole[e];this.nextChannel[e+"Acl"]={canViewMessages:t,canAddMessage:s,canEditMessage:n,canDeleteMessage:i,canViewMembers:h,canInvitePlayer:r,canKickPlayer:a,canAcceptJoinRequest:c,canMutePlayer:o}},SetNextChannelACLByInt(e,t,s,n,i,h,r,a,c,o){e=this.mappers.channelAclRole[e];this.nextChannel[e+"Acl"]={canViewMessages:!!t,canAddMessage:!!s,canEditMessage:!!n,canDeleteMessage:!!i,canViewMembers:!!h,canInvitePlayer:!!r,canKickPlayer:!!a,canAcceptJoinRequest:!!c,canMutePlayer:!!o}},FetchMembers(t,e,s,n,i,h){return this.gp.channels.fetchMembers({channelId:e,search:s,onlyOnline:n,limit:i,offset:h}).then(e=>{this.members.list=e.items,this.members.lastRequest="FetchMembers",this.canLoadMore=e.canLoadMore,this.lastLabel=t,this.handleResult(!0),this._trigger(this.conditions.OnMembersFetch),this._trigger(this.conditions.OnMembersAnyFetch)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnMembersFetchError),this._trigger(this.conditions.OnMembersAnyFetchError)})},FetchMoreMembers(t,e,s,n,i){return this.gp.channels.fetchMoreMembers({channelId:e,search:s,onlyOnline:n,limit:i}).then(e=>{this.members.list=e.items,this.members.lastRequest="FetchMembers",this.canLoadMore=e.canLoadMore,this.lastLabel=t,this.handleResult(!0),this._trigger(this.conditions.OnMembersFetchMore),this._trigger(this.conditions.OnMembersAnyFetchMore)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnMembersFetchMoreError),this._trigger(this.conditions.OnMembersAnyFetchMoreError)})},Join(e,t){return this.gp.channels.join({channelId:e,password:t}).then(()=>{this.handleResult(!0),this._trigger(this.conditions.OnJoin)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnJoinError)})},CancelJoin(e){return this.gp.channels.cancelJoin({channelId:e}).then(()=>{this.handleResult(!0),this._trigger(this.conditions.OnCancelJoin)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnCancelJoinError)})},Leave(e){return this.gp.channels.leave({channelId:e}).then(()=>{this.handleResult(!0),this._trigger(this.conditions.OnLeave)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnLeaveError)})},Kick(e,t){return this.gp.channels.kick({channelId:e,playerId:t}).then(()=>{this.handleResult(!0),this._trigger(this.conditions.OnKick)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnKickError)})},Mute(e,t,s){return this.gp.channels.mute({channelId:e,playerId:t,seconds:s}).then(()=>{this.handleResult(!0),this._trigger(this.conditions.OnMute)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnMuteError)})},Unmute(e,t){return this.gp.channels.unmute({channelId:e,playerId:t}).then(()=>{this.handleResult(!0),this._trigger(this.conditions.OnUnmute)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnUnmuteError)})},FetchJoinRequests(e,t,s){return this.gp.channels.fetchJoinRequests({channelId:e,limit:t,offset:s}).then(e=>{this.joinRequests.list=e.items,this.joinRequests.lastRequest="FetchJoinRequests",this.canLoadMore=e.canLoadMore,this.handleResult(!0),this._trigger(this.conditions.OnJoinRequestsFetch)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnJoinRequestsFetchError)})},FetchMoreJoinRequests(e,t){return this.gp.channels.fetchMoreJoinRequests({channelId:e,limit:t}).then(e=>{this.joinRequests.list=e.items,this.joinRequests.lastRequest="FetchJoinRequests",this.canLoadMore=e.canLoadMore,this.handleResult(!0),this._trigger(this.conditions.OnJoinRequestsFetchMore)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnJoinRequestsFetchMoreError)})},FetchSentJoinRequests(e,t){return this.gp.channels.fetchSentJoinRequests({limit:e,offset:t}).then(e=>{this.joinRequests.list=e.items,this.joinRequests.lastRequest="FetchSentJoinRequests",this.canLoadMore=e.canLoadMore,this.handleResult(!0),this._trigger(this.conditions.OnSentJoinRequestsFetch)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnSentJoinRequestsFetchError)})},FetchMoreSentJoinRequests(e){return this.gp.channels.fetchMoreSentJoinRequests({limit:e}).then(e=>{this.joinRequests.list=e.items,this.joinRequests.lastRequest="FetchSentJoinRequests",this.canLoadMore=e.canLoadMore,this.handleResult(!0),this._trigger(this.conditions.OnSentJoinRequestsFetchMore)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnSentJoinRequestsFetchMoreError)})},AcceptJoinRequest(e,t){return this.gp.channels.acceptJoinRequest({channelId:e,playerId:t}).then(()=>{this.handleResult(!0),this._trigger(this.conditions.OnAcceptJoinRequest)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnAcceptJoinRequestError)})},RejectJoinRequest(e,t){return this.gp.channels.rejectJoinRequest({channelId:e,playerId:t}).then(()=>{this.handleResult(!0),this._trigger(this.conditions.OnRejectJoinRequest)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnRejectJoinRequestError)})},FetchInvites(e,t){return this.gp.channels.fetchInvites({limit:e,offset:t}).then(e=>{this.invites.list=e.items,this.invites.lastRequest="FetchInvites",this.canLoadMore=e.canLoadMore,this.handleResult(!0),this._trigger(this.conditions.OnInvitesFetch)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnInvitesFetchError)})},FetchMoreInvites(e){return this.gp.channels.fetchMoreInvites({limit:e}).then(e=>{this.invites.list=e.items,this.invites.lastRequest="FetchInvites",this.canLoadMore=e.canLoadMore,this.handleResult(!0),this._trigger(this.conditions.OnInvitesFetchMore)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnInvitesFetchMoreError)})},FetchChannelInvites(e,t,s){return this.gp.channels.fetchChannelInvites({channelId:e,limit:t,offset:s}).then(e=>{this.invites.list=e.items,this.invites.lastRequest="FetchChannelInvites",this.canLoadMore=e.canLoadMore,this.handleResult(!0),this._trigger(this.conditions.OnChannelInvitesFetch)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnChannelInvitesFetchError)})},FetchMoreChannelInvites(e,t){return this.gp.channels.fetchMoreChannelInvites({channelId:e,limit:t}).then(e=>{this.invites.list=e.items,this.invites.lastRequest="FetchChannelInvites",this.canLoadMore=e.canLoadMore,this.handleResult(!0),this._trigger(this.conditions.OnChannelInvitesFetchMore)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnChannelInvitesFetchMoreError)})},FetchSentInvites(e,t){return this.gp.channels.fetchSentInvites({limit:e,offset:t}).then(e=>{this.invites.list=e.items,this.invites.lastRequest="FetchSentInvites",this.canLoadMore=e.canLoadMore,this.handleResult(!0),this._trigger(this.conditions.OnSentInvitesFetch)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnSentInvitesFetchError)})},FetchMoreSentInvites(e){return this.gp.channels.fetchMoreSentInvites({limit:e}).then(e=>{this.invites.list=e.items,this.invites.lastRequest="FetchSentInvites",this.canLoadMore=e.canLoadMore,this.handleResult(!0),this._trigger(this.conditions.OnSentInvitesFetchMore)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnSentInvitesFetchMoreError)})},SendInvite(e,t){return this.gp.channels.sendInvite({channelId:e,playerId:t}).then(()=>{this.handleResult(!0),this._trigger(this.conditions.OnSendInvite)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnSendInviteError)})},CancelInvite(e,t){return this.gp.channels.cancelInvite({channelId:e,playerId:t}).then(()=>{this.handleResult(!0),this._trigger(this.conditions.OnCancelInvite)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnCancelInviteError)})},AcceptInvite(e){return this.gp.channels.acceptInvite({channelId:e}).then(()=>{this.handleResult(!0),this._trigger(this.conditions.OnAcceptInvite)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnAcceptInviteError)})},RejectInvite(e){return this.gp.channels.rejectInvite({channelId:e}).then(()=>{this.handleResult(!0),this._trigger(this.conditions.OnRejectInvite)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnRejectInviteError)})},FetchMessages(t,e,s,n,i){return this.gp.channels.fetchMessages({tags:stoarr(s),channelId:e,limit:n,offset:i}).then(e=>{this.messages.list=e.items,this.messages.lastRequest="FetchMessages",this.canLoadMore=e.canLoadMore,this.lastLabel=t,this.handleResult(!0),this._trigger(this.conditions.OnMessagesFetch),this._trigger(this.conditions.OnMessagesAnyFetch)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnMessagesFetchError),this._trigger(this.conditions.OnMessagesAnyFetchError)})},FetchMoreMessages(t,e,s,n){return this.gp.channels.fetchMoreMessages({tags:stoarr(s),channelId:e,limit:n}).then(e=>{this.messages.list=e.items,this.messages.lastRequest="FetchMessages",this.canLoadMore=e.canLoadMore,this.lastLabel=t,this.handleResult(!0),this._trigger(this.conditions.OnMessagesFetchMore),this._trigger(this.conditions.OnMessagesAnyFetchMore)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnMessagesFetchMoreError),this._trigger(this.conditions.OnMessagesAnyFetchMoreError)})},FetchPersonalMessages(t,e,s,n,i){return this.gp.channels.fetchPersonalMessages({tags:stoarr(s),playerId:e,limit:n,offset:i}).then(e=>{this.messages.list=e.items,this.messages.lastRequest="FetchPersonalMessages",this.canLoadMore=e.canLoadMore,this.lastLabel=t,this.handleResult(!0),this._trigger(this.conditions.OnPersonalMessagesFetch),this._trigger(this.conditions.OnPersonalMessagesAnyFetch)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnPersonalMessagesFetchError),this._trigger(this.conditions.OnPersonalMessagesAnyFetchError)})},FetchMorePersonalMessages(t,e,s,n){return this.gp.channels.fetchMorePersonalMessages({tags:stoarr(s),playerId:e,limit:n}).then(e=>{this.messages.list=e.items,this.messages.lastRequest="FetchPersonalMessages",this.canLoadMore=e.canLoadMore,this.lastLabel=t,this.handleResult(!0),this._trigger(this.conditions.OnPersonalMessagesFetchMore),this._trigger(this.conditions.OnPersonalMessagesAnyFetchMore)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnPersonalMessagesFetchMoreError),this._trigger(this.conditions.OnPersonalMessagesAnyFetchMoreError)})},FetchFeedMessages(t,e,s,n,i){return this.gp.channels.fetchFeedMessages({tags:stoarr(s),playerId:e,limit:n,offset:i}).then(e=>{this.messages.list=e.items,this.messages.lastRequest="FetchFeedMessages",this.canLoadMore=e.canLoadMore,this.lastLabel=t,this.handleResult(!0),this._trigger(this.conditions.OnFeedMessagesFetch),this._trigger(this.conditions.OnFeedMessagesAnyFetch)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnFeedMessagesFetchError),this._trigger(this.conditions.OnFeedMessagesAnyFetchError)})},FetchMoreFeedMessages(t,e,s,n){return this.gp.channels.fetchMoreFeedMessages({tags:stoarr(s),playerId:e,limit:n}).then(e=>{this.messages.list=e.items,this.messages.lastRequest="FetchFeedMessages",this.canLoadMore=e.canLoadMore,this.lastLabel=t,this.handleResult(!0),this._trigger(this.conditions.OnFeedMessagesFetchMore),this._trigger(this.conditions.OnFeedMessagesAnyFetchMore)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnFeedMessagesFetchMoreError),this._trigger(this.conditions.OnFeedMessagesAnyFetchMoreError)})},SendMessage(e,t,s){return this.gp.channels.sendMessage({channelId:e,text:t,tags:stoarr(s)}).then(e=>{this.curMessage=e,this.curPlayer=e.player||{},this.handleResult(!0),this._trigger(this.conditions.OnMessagesSend)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnMessagesSendError)})},SendPersonalMessage(e,t,s){return this.gp.channels.sendPersonalMessage({playerId:e,text:t,tags:stoarr(s)}).then(e=>{this.curMessage=e,this.curPlayer=e.player||{},this.handleResult(!0),this._trigger(this.conditions.OnMessagesSend)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnMessagesSendError)})},SendFeedMessage(e,t,s){return this.gp.channels.sendFeedMessage({playerId:e,text:t,tags:stoarr(s)}).then(e=>{this.curMessage=e,this.curPlayer=e.player||{},this.handleResult(!0),this._trigger(this.conditions.OnMessagesSend)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnMessagesSendError)})},EditMessage(e,t){return this.gp.channels.editMessage({messageId:e,text:t}).then(e=>{this.curMessage=e,this.curPlayer=e.player||{},this.handleResult(!0),this._trigger(this.conditions.OnMessagesEdit)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnMessagesEditError)})},DeleteMessage(e){return this.gp.channels.deleteMessage({messageId:e}).then(()=>{this.curMessage={id:e},this.handleResult(!0),this._trigger(this.conditions.OnMessagesDelete)}).catch(e=>{this.handleResult(!1,e),this._trigger(this.conditions.OnMessagesDeleteError)})},OpenMainChat(){return this.gp.channels.openChat()},OpenChat(e,t){return this.gp.channels.openChat({id:e,tags:stoarr(t)})},OpenPersonalChat(e,t){return this.gp.channels.openPersonalChat({playerId:e,tags:stoarr(t)})},OpenFeed(e,t){return this.gp.channels.openFeed({playerId:e,tags:stoarr(t)})},LoadFromJSON(e){try{var t=JSON.parse(e);if(!("isReady"in t))throw new Error("Data was corrupted");this.LoadFromJson(t)}catch(e){this._trigger(this.conditions.OnLoadJsonError)}}};